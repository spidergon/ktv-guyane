---
import HeroItem from './HeroItem.astro';
import HeroPlayer from '@components/HeroPlayer.jsx';

let data;

try {
	const response = await fetch('https://api.dailymotion.com/videos?fields=id%2Cchannel%2Ctitle%2Cthumbnail_120_url&limit=5&owners=x2nsv7s');
	data = await response.json();
} catch (error) {
	console.error(error);
}

const src='https://res.cloudinary.com/cserviusprod/video/upload/v1654305801/ktv/vids/video06.mp4'
---

<section>
	<div class="container grid">
		<div>
			<HeroPlayer client:load src={src} />
		</div>
		<div class="playlist">
			<h2>Les denières vidéos</h2>
			<div>
				{data?.list && data.list.map(({id, title, channel, thumbnail_120_url}) => (
					<HeroItem {id} {title} {channel} {thumbnail_120_url} />
				))}
			</div>
		</div>
	</div>
</section>

<style>
	section {
		margin-top: 1.5em;
	}
	.playlist {
		margin-top: 1em;
		padding-inline: 1em;
	}
	.container {
		padding: 0;
	}
	@media (min-width: 800px) {
		.container {
			padding-inline: 1em;
		}
  }
	@media (min-width: 970px) {
		.container {
			grid-template-columns: 1fr auto;
		}
		.playlist {
			margin-top: 0;
		}
		h2 {
			margin-top: -0.4em;
		}
	}
</style>